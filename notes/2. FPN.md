# 《Feature Pyramid Networks for Object Detection》阅读笔记

## 简介

多尺度目标识别是 CV 方面的难题，FPN 的提出是为了解决这个问题的。早期的目标检测系统实现多尺度用的是图像金字塔分别提取特征，成本太高，所以很多深度学习目标检测网络都避免使用它。Faster R-CNN 这种网络预先设定多尺度锚框，但是因为单层特征图的特性损失了多尺度信息。
FPN 是一种横向连接的自顶向下架构，利用了深层卷积网络的多尺度、金字塔层级结构构建特征金字塔，用于构建所有尺度下的高特征特征图。

> 特征信息越丰富，看到的细节就越多。深层的卷积层因为经过很多的卷积和池化，感受野大，所以看到的东西更加“宏观”，相应地就可能导致了细节的丢失。

## 背景

处理多尺度信息，在图像金字塔中提取特征，构成特征金字塔是基本而传统的做法。金字塔赋予模型尺度不变性，而且所有层次都有强特征性。
但是这种做法太慢了。所以 Faster R-CNN 就用单尺度特征图快速检测。
还有另外一种做法是用卷积神经网络内部的各个特征层次直接预测，例如 SSD。

> 卷积网络的浅层分辨率高，细节强，语义信息弱；深层分辨率低，细节弱，语义信息强。
> SSD 处理小物体时，可能在深层网络中因为分辨率低而丢失特征。为了避免使用特征信息弱的部分，它从高层特征开始构建金字塔再额外增加几个新的层。既增加成本又浪费了浅层的计算结果。

由上，FPN 的目标就是充分利用卷积网的层次结构创建特征金字塔，并且保证在所有尺度下的特征都具有强特征。那我们就要取长补短，把低分辨率强特征和高分辨率弱特征结合起来。
FPN 的网络结构示意如下。
![FPN的结构示意](../images/FPN.png)
其中左边的 Top 结构仅仅在最高分辨率层（最底层的、宏观的层面）预测。右边的 Bottom 结构（**FPN 采取的结构**）把它改造成了“特征金字塔”，每一层都会做出预测。

## 实现

卷积网络的特性是由浅到深细节递减语义递增。FPN 需要构建一个含有高级语义的特征金字塔。
这个特征金字塔网络对于所有卷积网络都是通用的。本文研究重点是 RPN 和 Fast R-CNN。
